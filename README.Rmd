---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/"
)
```

# PTTmineR <img src="man/figures/logo.svg" align="right" alt="" width="120" />

ç°¡å–®ã€å¿«é€Ÿåœ°çˆ¬å– PTT ä¸Šçš„è³‡æ–™ï¼Œè®“ä½¿ç”¨è€…èƒ½æ›´å°ˆæ³¨åœ¨åˆ†æå·¥ä½œä¸Šï¼

## Why `PTTmineR` ?
- å‹å–„ä½¿ç”¨è€…çš„èªæ„åŒ–ä½¿ç”¨æ–¹å¼
- æ•´åˆå¤šç¨® PTT æ–‡ç« æœå°‹æ–¹å¼
- å…§éƒ¨é«˜æ•ˆç‡çš„è³‡æ–™è™•ç†( `data.table` )
- æ”¯æŒå¹³è¡Œé‹ç®—( `futrue` )

## Installation

å®‰è£æœ€æ–°çš„ `PTTmineR` é–‹ç™¼ç‰ˆæœ¬ï¼š
```r
if (!requireNamespace("remotes"))
  install.packages("remotes")

remotes::install_github("shihjyun/PTTmineR")
```

## Getting started

### è¼‰å…¥ `PTTmineR` å¥—ä»¶

```{r }
library(PTTmineR)
```

### ä½¿ç”¨ `PTTmineR$new` å‰µå»ºç¬¬ä¸€å€‹ miner
ä½ å¯ä»¥å¹«é€™æ”¯ miner æ‰€è¦åŸ·è¡Œçš„çˆ¬èŸ²ä»»å‹™å–ä¸€å€‹ç°¡å–®çš„åç¨±
```{r }
rookie_miner <- PTTmineR$new(task.name = "Mr. Meeseeks")
# inspect your miner's metadata
rookie_miner

```
æ¥ä¸‹ä¾†çš„ä»»ä½•æ“ä½œéƒ½ä¸éœ€è¦å†ç”¨åˆ° `<-` æˆ–æ˜¯ `=` ç¶å®šåå­—åˆ°ç‰©ä»¶ä¸Š(é™¤éä½ éœ€è¦å†å‰µå»ºæ–°çš„ miner ç‰©ä»¶)ï¼Œ
åŸå› æ˜¯åœ¨ `PTTmineR` å¥—ä»¶çš„è¨­è¨ˆä¸Šæœ‰ **Reference Semantics** çš„ç‰¹æ€§ï¼Œæ‰€ä»¥æ¥ä¸‹ä¾†æ‰€æ“ä½œçš„ function éƒ½æœƒæ˜¯
 side-effect functionï¼Œå°é€™éƒ¨åˆ†ä¸ç†è§£çš„è©±ä¸¦ä¸æœƒå½±éŸ¿å¥—ä»¶çš„ä½¿ç”¨ï¼Œæœ‰èˆˆè¶£çš„è©±å¯ä»¥åƒè€ƒä¹‹å¾Œçš„æŠ€è¡“æ–‡ä»¶æœƒæ›´æ·±å…¥èªªæ˜ï¼Œ
è€Œç¾åœ¨ä½ åªéœ€è¦é€éæ¥ä¸‹ä¾†çš„ç¯„ä¾‹çŸ¥é“çˆ¬åˆ°çš„è³‡æ–™æœ€å¾Œéƒ½åˆ°äº†å“ªè£¡å°±å¥½äº† ğŸ˜ï¼

### ä½¿ç”¨ `mine_ptt()` ç²å¾—è³‡æ–™

åœ¨ `mine_ptt()` function ä¸­é™¤äº† `ptt.miner` éœ€è¼¸å…¥å‰›å‰›å‰µå»º miner è®Šæ•¸å¤–ï¼Œä¹Ÿå¯ä»¥è¼¸å…¥ä¸€ä¸‹åƒæ•¸ï¼š

- `board` : å­—ä¸²ï¼Œå¿…å¡«ï¼Œä½ æƒ³è¦çˆ¬çš„æ¿ e.g. Gossiping, Beaudy, HatePolitics
- `keyword` : å­—ä¸²ï¼Œé¸å¡«ï¼Œåœ¨æ¿ä¸­é€éæ¨™é¡Œé—œéµå­—æœå°‹
- `author` : å­—ä¸²ï¼Œé¸å¡«ï¼Œåœ¨æ¿ä¸­é€éæ–‡ç« ä½œè€…æœå°‹
- `recommend` : æ•¸å­—ï¼Œé¸å¡«ï¼Œåœ¨æ¿ä¸­é€éæ–‡ç« æ·¨æ¨æ–‡æœå°‹
- `min.date` : å­—ä¸²ï¼Œé¸å¡«ï¼Œçˆ¬åˆ°ä»€éº¼æ™‚é–“é»ç‚ºæ­¢ e.g. `2018-01-01`, `2019-11-01 15:00:01`
- `last.n.page` : æ•¸å­—ï¼Œå¾æœ€å‰é¢ä¸€é é–‹å§‹çˆ¬å¤šå°‘é 

ä»¥ä¸Šæåˆ°çš„å„ç¨®æœå°‹æ¢ä»¶éƒ½å¯ä»¥æ··æ­ä½¿ç”¨ï¼
```{r eval=FALSE}
# You can ...
mine_ptt(ptt.miner = rookie_miner,
         board = "Gossiping",
         last.n.page = 10)
# or ...(Using `%>%` is more semantic !!)
rookie_miner %>% 
  mine_ptt(board = "Gossiping",
           last.n.page = 10)

#> ğŸ™‰ PTTmineR mining from ptt on your setting ... DONE
  
```
é›–ç„¶ `PTTmineR` çš„ function éƒ½æ˜¯ side-effect functionï¼Œä½†ä¸€æ¨£å¯ä»¥æ”¯æŒ `%>%` é€²è¡Œèªæ„åŒ–æ“ä½œï¼š

ã€Œrookie_miner å¾ Gossiping æ¿ä¸­çˆ¬æœ€æ–°çš„åé æ–‡ç« å›ä¾†ï¼ã€

```{r eval=FALSE}
rookie_miner

#> *** PTTMINER ***
#> * task name: Mr. Meeseeks
#> * total posts: 192
#> * total comments: 6487
#> * miner's size: 1.52 MB
#> * last crawling date time: 2019-12-02 15:45:03
```

### ä½¿ç”¨ `export_ptt()` è¼¸å‡ºçˆ¬ä¸‹ä¾†çš„è³‡æ–™
é™¤äº† `ptt.miner` è¦æ”¾å…¥ miner ç‰©ä»¶å¤–ï¼Œ`export.type` åƒæ•¸ç›®å‰æ¥å—ä¸‰ç¨®è³‡æ–™è¼¸å‡ºæ ¼å¼ï¼š

- `"dt"` : `data.table` æ ¼å¼ï¼Œç¿’æ…£ `data.tabla` æ“ä½œçš„ä½¿ç”¨è€…å¯ä»¥ä½¿ç”¨
- `"tbl"` : `tibble` æ ¼å¼ï¼Œç¿’æ…£ `tidyverse` æ“ä½œçš„ä½¿ç”¨è€…å¯ä»¥ä½¿ç”¨
- `"nested_tbl"` : å·¢ç‹€ `tibble` æ ¼å¼ï¼Œåªæœ‰ä¸€å¼µè¡¨ï¼Œå„ç¯‡æ–‡ç« çš„æ¨æ–‡å…§å®¹æœƒä»¥å–®å€‹ column çš„å½¢å¼å„²å­˜

è€Œæœ€å¾Œçš„ `obj.name` è¦å¡«å…¥æœ€å¾Œè¦å›å‚³åˆ°å…¨åŸŸç’°å¢ƒçš„ç‰©ä»¶åç¨±

```{r eval=FALSE}
rookie_miner %>% 
  export_ptt(export.type = "tbl",
             obj.name = "tbl_result")

colnames(tbl_result$post_info_tbl)

#> [1] "post_id"        "post_author"    "post_category"  "post_title"     
#> [5] "post_date_time" "post_ip"        "post_country"   "post_content"  
#> [9] "post_board"  

colnames(tbl_result$post_comment_tbl)

#> [1] "post_id"        "push_type"      "push_id"        "push_content"   
#> [5] "push_ip"        "push_date_time"

```

ä¸€èˆ¬ä¾†èªªåœ¨è‡ªå·±å®šç¾©çš„ç‰©ä»¶åç¨±ä¸­æœƒå¾—åˆ°å…©å¼µè¡¨ï¼š

- `post_info_tbl` : æ–‡ç« åŸºæœ¬è³‡æ–™
- `post_comment_tbl` : æ¨æ–‡çš„åŸºæœ¬è³‡æ–™

è€Œä»¥ä¸Šæ‰€é¡¯ç¤ºçš„æ¬„ä½å°±æ˜¯ç¾éšæ®µ `PTTmineR` èƒ½å¤ çˆ¬å–çš„è³‡æ–™

#### çœŸæ­£çš„è³‡æ–™åœ¨å“ªè£¡ï¼Ÿ
å…¶å¯¦çˆ¬ä¸‹ä¾†çš„è³‡æ–™éƒ½æ˜¯å­˜æ”¾åœ¨ miner ç‰©ä»¶ä¸­ï¼Œä½†æœƒæœ‰é¡å¤– `export_ptt()` çš„è¨­è¨ˆæ˜¯å¸Œæœ›ä½¿ç”¨è€…ç›¡é‡ä¸è¦å»ä¿®æ”¹åˆ° miner ç‰©ä»¶ä¸­çš„åŸå§‹è³‡æ–™
```{r eval=FALSE}
rookie_miner$result_dt
```

### ä½¿ç”¨ `update_ptt()` æ›´æ–°å·²ç¶“çˆ¬çš„æ–‡ç« æ¨æ–‡

æˆ‘å€‘çŸ¥é“æ¨æ–‡æ˜¯æœƒå‹•æ…‹å¢åŠ çš„ï¼Œæ‰€ä»¥æˆ‘å€‘è¦åˆ†ææ™‚æœ‰å¯èƒ½æœƒæƒ³çŸ¥é“ä¹‹å‰çˆ¬éçš„æ–‡ç« æœ‰æ²’æœ‰æ–°çš„æ¨æ–‡ç”¢ç”Ÿï¼Œç›¡é‡ä¿æŒè³‡æ–™å®Œæ•´æ€§

```{r eval=FALSE}
rookie_miner

#> *** PTTMINER ***
#> * task name: Mr. Meeseeks
#> * total posts: 192
#> * total comments: 6487
#> * miner's size: 1.52 MB
#> * last crawling date time: 2019-12-02 15:45:03

update_id <- rookie_miner$result_dt$post_info_dt$post_id

rookie_miner %>% 
  update_ptt(update.post.id = update_id)

rookie_miner

```


### ä½¿ç”¨ `plan(multiprocess)` é€²è¡Œå¹³è¡Œçˆ¬å–

å¦‚æœæ²’æœ‰åšç‰¹åˆ¥è¨­å®šçš„è©±ï¼ŒR éƒ½æ˜¯ä»¥å–®åŸ·è¡Œç·’ä¾†é€²è¡Œçˆ¬å–ä½œæ¥­ï¼Œå¦‚æœè¦åšå¤§é‡çš„çˆ¬å–ï¼Œå¯èƒ½æœƒéå¸¸èŠ±æ™‚é–“ï¼Œä½†

